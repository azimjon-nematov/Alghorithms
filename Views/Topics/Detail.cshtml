@{
    Layout = "/Views/Shared/_Layout.cshtml";
}

@using Alghorithms.Models
@model List<Content>
            <header class="site-header d-flex flex-column justify-content-center align-items-center">
                <div class="container">
                    <div class="row justify-content-center align-items-center">

                        <div class="col-lg-11 col-12 mb-5">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="index.html">Homepage</a></li>

                                    <li class="breadcrumb-item active" aria-current="page">Web Design</li>
                                </ol>
                            </nav>

                            <h2 class="text-white">@ViewData["Title"]</h2>
                        </div>

                        @*<div class="col-lg-5 col-12">
                            <div class="topics-detail-block bg-white shadow-lg">
                                <img src="~/images/topics/undraw_Remote_design_team_re_urdx.png" class="topics-detail-block-image img-fluid">
                            </div>
                        </div>*@

                    </div>
                </div>
            </header>


            <section class="topics-detail-section section-padding" id="topics-detail">
                <div class="container">
                    <div class="row">

                    @foreach (var content in Model)
                    {
                        <div class="col-lg-8 col-12 m-auto">
                            @if(content.ContentTypeName == "Title")
                            {
                                <h3 class="mb-4">@content.Data</h3>
                            }
                            else if(content.ContentTypeName == "Text")
                            {
                                <p>@content.Data</p>
                            }
                            else if(content.ContentTypeName == "Subtitle")
                            {
                                
                            }
                            else if(content.ContentTypeName == "Image")
                            {
                                <div class="row my-4">
                                    <img src="@content.Data" class="topics-detail-block-image img-fluid">
                                </div>
                            }
                            else if(content.ContentTypeName == "MarkedText")
                            {
                                var items = content.Data.Split('\n');
                                <ul>
                                @foreach (var item in items)
                                {
                                    <li>@item</li>
                                }
                                </ul>
                            }
                            else if(content.ContentTypeName == "Code")
                            {
                                    @*@content.codes.First().LanguageName <br>
                                    @Html.Raw(@content.codes.First().Code)*@

                                    <script>
                                        var codes@(content.CodeListId) =[
                                            `@Html.Raw(@content.codes.First().Code)`
                                            @for(var i = 1; i < @content.codes.Count; ++i)
                                            {
                                            @(",`");@Html.Raw(@content.codes[i].Code);@("`");
                                            }
                                        ];

                                        function selectCode@(content.CodeListId)() {
                                            var myselect = document.getElementById("codeselect@(content.CodeListId)");
                                            var index = myselect.selectedIndex;
                                            index = (index == -1 || index == undefined) ? 0 : index;
                                            document.getElementById("codeviewer@(content.CodeListId)").innerText = codes@(content.CodeListId)[index];
                                        }

                                    </script>
                                    
                                    <div class="syntaxhighlighter">
                                        <div class="toolbar">
                                            <select id="codeselect@(content.CodeListId)" onchange="selectCode@(content.CodeListId)()">
                                            @for (var i=0; i < content.codes.Count; i++)
                                            {    
                                                <option value="@content.codes[i].LanguageId">
                                                    @content.codes[i].LanguageName
                                                </option>
                                            }
                                            </select>
                                        </div>
                                        <div style="padding: 10px">
<span class="codetest" id="codeviewer@(content.CodeListId)"></span>
                                        </div>
                                        
                                    </div>

                                    <script>
                                        selectCode@(content.CodeListId)();
                                    </script>

                            }
                            else if(content.ContentTypeName == "Warning")
                            {
                                <blockquote>@content.Data</blockquote>
                            }

                        </div>
                    }

                        @*<div class="col-lg-8 col-12 m-auto">
                            <h3 class="mb-4">Introduction to Web Design</h3>

                            <p>So how can you stand out, do something unique and interesting, build an online business, and get paid enough to change life. Please visit TemplateMo website to download free website templates.</p>

                            <p><strong>There are so many ways to make money online</strong>. Below are several platforms you can use to find success. Keep in mind that there is no one path everyone can take. If that were the case, everyone would have a million dollars.</p>

                            <blockquote>
                                Freelancing your skills isn’t going to make you a millionaire overnight.
                            </blockquote>

                            <div class="row my-4">
                                <div class="col-lg-6 col-md-6 col-12">
                                    <img src="~/images/businesswoman-using-tablet-analysis.jpg" class="topics-detail-block-image img-fluid">
                                </div>

                                <div class="col-lg-6 col-md-6 col-12 mt-4 mt-lg-0 mt-md-0">
                                    <img src="~/images/colleagues-working-cozy-office-medium-shot.jpg" class="topics-detail-block-image img-fluid">
                                </div>
                            </div>

                            <p>Most people start with freelancing skills they already have as a side hustle to build up income. This extra cash can be used for a vacation, to boost up savings, investing, build business.</p>
                        </div>*@

                    </div>
                </div>
            </section>
<script type="text/javascript">
    // эта ссамая полезная функция
    function createElementFromHTML(htmlString) {
        var div = document.createElement('div');
        div.innerHTML = htmlString.trim();
        // Change this to div.childNodes to support multiple top-level nodes.
        return div.firstChild;
    }

    // отправление запроса на добавление коментария
    function addComment() {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'comment.php');
        var animeId = encodeURIComponent(document.getElementById("animeId").value);
        var text = encodeURIComponent(document.getElementById("text").value);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send('animeId='+animeId+'&text='+text);
        xhr.onreadystatechange = handleFunc;

        function handleFunc() {
            if(xhr.readyState === 4 && xhr.status === 200) {
	            var ul = document.getElementById("list");
	            ul.appendChild(createElementFromHTML(xhr.responseText));
	            document.getElementById("text").value = '';
	            var li = document.getElementById("nocomments");
	            if (typeof(li) != 'undefined' && li != null)
	            {
		            li.parentNode.removeChild(li);
	            }
            } else {
	            alert(xhr.responseText);
            }
        };
    }
</script>


            <section class="section-padding section-bg">
                <div class="container">
                    <div class="row justify-content-center">

                        @*<div class="col-lg-5 col-12">
                            <img src="~/images/rear-view-young-college-student.jpg" class="newsletter-image img-fluid" alt="">
                        </div>*@

                        <div class="col-lg-6 col-12">
                            <form action="#" method="post" class="custom-form contact-form" role="form">
                                <div class="row">
                                    
                                    <div class="col-lg-12 col-12 m-auto">
                                        <h4 class="mb-4">Напишите комментарий к алгоритму</h4>
                                    </div>

                                    <div class="col-lg-12 col-12">
                                        <div class="form-floating">
                                            <textarea class="form-control" id="message" name="message" placeholder="Текст комментария"></textarea>
                                            
                                            <label for="floatingTextarea">Текст комментария</label>
                                        </div>
                                    </div>

                                    <div class="col-lg-4 col-12 ms-auto">
                                        <button onclick="addComment()" class="form-control">Отправить</button>
                                    </div>

                                </div>
                            </form>
                        </div>

                    </div>
                </div>
            </section>


            @*TODO: comments*@